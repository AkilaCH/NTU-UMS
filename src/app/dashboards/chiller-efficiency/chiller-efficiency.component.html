<div class="card main-card-height" id="chillerEfficiency">
  <div class="card-header p-0">
    <span class="d-none d-xl-block  pl-3 pt-3 pb-3 font-secondary">
      <span class="d-inline-block font-secondary mr-4">
        Date Range<br>
        <date-range-picker [disabled] = "!isDone.chillerEfficiencyChartData" [maxDate]="today" [maxDateRange]="'1month'" [disabled]="chartLoading" position="bottom-left" [(dateRange)]="dateRange" (dateRangeChange)="dateRangedChanged()">
        </date-range-picker>
      </span>
      <span class="d-inline-block font-secondary mr-4">
        Plant
        <app-combo-box [disable] = "!isDone.chillerEfficiencyChartData" class="select-box-dark"  [dataSource]="plantList" [selected]="selectedPlant" [enableAll]="false"
          (selectedChange)="plantChanged($event)"></app-combo-box>
      </span>
      <span class="d-inline-block font-secondary mr-4">
        Chiller
        <app-combo-box [disable] = "!isDone.chillerEfficiencyChartData" class="select-box-dark"  [dataSource]="chillerList" [selected]="selectedChiller"
          (selectedChange)="chillerChanged($event)"></app-combo-box>
      </span>
      <span class="d-inline-block font-secondary mr-4">
        yScale
        <app-combo-box [disable] = "!isDone.chillerEfficiencyChartData" class="select-box-dark"  [dataSource]="scaleList" [selected]="scaleListSelected" [enableAll]="false"
          (selectedChange)="scaleChanged($event)"></app-combo-box>
      </span>

      <span class="tab-primary float-right font-primary" (click)="setTabIndex(1)"
        [ngClass]="{'active': tabIndex == 1}">Table</span>
      <span class="tab-primary float-right font-primary" (click)="setTabIndex(0)"
        [ngClass]="{'active': tabIndex == 0}">Chart</span>
    </span>
    <div class="d-xl-none pl-3 pt-3 pb-3 font-secondary">
      <div class="row w-100">
        <div class="col-8">
          <span class="d-inline-block font-secondary mr-4">
            Date Range
            <date-range-picker [disabled] = "!isDone.chillerEfficiencyChartData" [maxDate]="today" [maxDateRange]="'1month'" [disabled]="chartLoading" position="bottom-left" [(dateRange)]="dateRange" (dateRangeChange)="dateRangedChanged()">
            </date-range-picker>
          </span>
          <span class="d-inline-block font-secondary mr-4">
            Plant
            <app-combo-box [disable] = "!isDone.chillerEfficiencyChartData" class="select-box-dark"  [dataSource]="plantList" [selected]="selectedPlant" [enableAll]="false"
              (selectedChange)="plantChanged($event)"></app-combo-box>
          </span>
          <span class="d-inline-block font-secondary mr-4">
            Chiller
            <app-combo-box [disable] = "!isDone.chillerEfficiencyChartData" class="select-box-dark"  [dataSource]="chillerList" [selected]="selectedChiller"
              (selectedChange)="chillerChanged($event)"></app-combo-box>
          </span>
          <span class="d-inline-block font-secondary mr-4">
            yScale
            <app-combo-box [disable] = "!isDone.chillerEfficiencyChartData" class="select-box-dark"  [dataSource]="scaleList" [selected]="scaleListSelected" [enableAll]="false"
              (selectedChange)="scaleChanged($event)"></app-combo-box>
          </span>
        </div>
        <div class="col-4 ">
          <select [disabled] = "!isDone.chillerEfficiencyChartData" class="form-control mt-4 form-control-sm select-box-dark" (change)="setTabIndex($event.target.value)"
            [(ngModel)]="tabIndex">
            <option value="0">Chart</option>
            <option value="1">Table</option>
          </select>
        </div>
      </div>
    </div>
  </div>
  <section *ngIf="tabIndex == 0" style="position: relative;">
    <div class="card-body main-card-height card-scroll">
      <!-- <div *ngIf="chartLoading" class="loading-area">
        <img  alt="loader" class="loading-icon" src="assets/img/loader.svg" />
      </div> -->
      <div class="p-3 ml-1" >        
        <app-print-preview *ngIf="!chartLoading && chillerEfficiencyChartData"  [className]="'customp-chiller-efficiency'" [targetHtml] = "'chillerEfficiency'" [title]="'Chiller Efficiency'"></app-print-preview>
        <app-chart-loader [isDone] = "isDone.chillerEfficiencyChartData">
          <app-zoomline   [dataSource]="chillerEfficiencyChartData"></app-zoomline>
        </app-chart-loader>
      </div>
    </div>
  </section>
  <section *ngIf="tabIndex == 1">
    <div class="card-body main-card-height card-scroll">
      <div *ngIf="chartLoading" class="loading-area">
        <img  alt="loader" class="loading-icon" src="assets/img/loader.svg" />
      </div>
      <ngx-datatable *ngIf="!chartLoading" class="dark" [rows]="rows" [sortType]="sortType.multi" [columnMode]="columnMode.standard"
        [headerHeight]="50" [footerHeight]="50" rowHeight="auto" [limit]="18">
        <ngx-datatable-column name="Time" [width]="(tableWidth | async)">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{row.dateTime | date: 'y/MM/dd HH:mm'}}
          </ng-template>
        </ngx-datatable-column>
        <ngx-datatable-column name="Efficiency &nbsp;(kW/RT)" [width]="(tableWidth | async)">
          <ng-template let-row="row" ngx-datatable-cell-template>
            {{row.efficiency == null ? 'N/A' : row.efficiency | number:'1.0-2'}}
          </ng-template>
        </ngx-datatable-column>
      </ngx-datatable>
      <div *ngIf="!chartLoading && rows.length !=0" class="export-button">
        <button class="btn dark-button" type="button" (click)="exportToExcel()">Export to Excel</button>
      </div>
    </div>
  </section>
</div>
