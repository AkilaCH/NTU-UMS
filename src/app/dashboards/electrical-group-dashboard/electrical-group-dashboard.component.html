<div class="card h-100" id ="8daysProfile">
  <div class="card-header p-0 pl-2 pr-3">
    <div class="d-none d-xl-block">
      <span class="d-inline-block pl-3 pt-3 pb-3 font-secondary header-title">
        Electrical Low Tension > {{buildingName}} >
      </span>
      <span class="d-inline-block pl-3 pt-3 pb-3 font-secondary">
        <app-combo-box class="select-box-dark" [dataSource]="buildings" (selectedChange)="buildingChanged($event)"></app-combo-box>
      </span>
      <span class="tab-primary float-right font-primary" (click)="setTabIndex(6)" [ngClass]="{'active': tabIndex == 6}">EUI</span>
      <span class="tab-primary float-right font-primary" (click)="setTabIndex(3)" [ngClass]="{'active': tabIndex == 3}">Meter Tree</span>
      <span class="tab-primary float-right font-primary" (click)="setTabIndex(5)" [ngClass]="{'active': tabIndex == 5}">8-Day Profile</span>
      <span class="tab-primary float-right font-primary" (click)="setTabIndex(2)" [ngClass]="{'active': tabIndex == 2}">Equipment Breakdown</span>
      <span class="tab-primary float-right font-primary" (click)="setTabIndex(1)" [ngClass]="{'active': tabIndex == 1}">Equipment Distribution</span>
      <span class="tab-primary float-right font-primary" (click)="setTabIndex(0)" [ngClass]="{'active': tabIndex == 0}">Overview</span>
    </div>
    <div class="form-group row mb-0 row d-xl-none pr-2">
      <label class="col-12 col-sm-12 col-lg-6 col-form-label">Electrical Low Tension</label>

      <div class="col-12 col-sm-12 col-lg-6 pl-2 pr-0 pb-1">
        <app-combo-box class="select-box-dark" [dataSource]="buildings" (selectedChange)="buildingChanged($event)"></app-combo-box>
        <select (change)="setTabIndex($event.target.value)" [(ngModel)]="tabIndex" class="form-control mt-1 form-control-sm select-box-dark">
          <option value="0">Overview</option>
          <option value="1">Equipment Distribution</option>
          <option value="2">Equipment Breakdown</option>
          <option value="5">8-Day Profile</option>
          <option value="6">EUI</option>
          <option value="3">Meter Tree</option>
        </select>
      </div>
    </div>

  </div>
  <div class="card-body  h-100 card-scroll">
    <!-- tab index 0 -->
    <section *ngIf="tabIndex == 0">
      <div class="row">
        <div class="col-md-12 col-lg-6 col-xl-4 p-1">
          <div class="chart-card h-100">
            <div class="chart-card-header">
                <span>Overall Consumption</span>
                <date-range-picker [disabled] = "!isDone.overallConsumptioSquareData" [maxDate]="today" class="d-none d-xl-block" position="bottom-right" (dateRangeChange)="dateRangeListner('overall')" [(dateRange)]="overallDateRange"></date-range-picker>
            </div>
            <div class="chart-card-body custom-card-body">
              <div class="row h-100">
                <!-- <div class="col-12 input-date p-0">
                  <date-range-picker *ngIf="_reload"  [maxDate]="today" class="d-xl-none m-3" (dateRangeChange)="dateRangeListner('overall')" [(dateRange)]="overallDateRange"></date-range-picker>
                </div> -->

                <div class="col-12 col-sm-6 col-md-6 col-lg-6 col-xl-6 custom-view-pointer">
                  <app-chart-loader [isDone] = "isDone.overallConsumptioTotalData">
                    <app-data-pointer-none-image [color] = "this.colorMap.electric.secondary" [pointerText]="overallConsumptioTotalData" [unit]="'kWh'" type="kWh" [description]="'Total Consumption'" class=""></app-data-pointer-none-image>
                  </app-chart-loader>
                </div>
                <div class="col-12 col-sm-6 col-md-6 col-lg-6 col-xl-6 custom-view-pointer">
                  <app-chart-loader [isDone] = "isDone.overallConsumptioSquareData">
                    <app-data-pointer-none-image [color] = "this.colorMap.electric.secondary" [description]="squareMeterPointerDescription"
                                      [pointerText]="overallConsumptioSquareData"
                                      [unit]="'kWh/m<sup>2</sup>.yr'"
                                      type="kwhm2"></app-data-pointer-none-image>
                  </app-chart-loader>
                  </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-12 col-lg-6 col-xl-8 p-1 pt-0">
          <div class="chart-card h-100" id="30MinutConsumption">
            <div class="chart-card-header">
              <span class="header-title">30 min Consumption</span>
              <div class="d-flex align-items-center">
                <date-range-picker [disabled] = "!isDone.dailyConsumptionData" *ngIf="_reload" [maxDate]="_maxTodayConsumptionDate" [minDate] = "_minTodayConsumptionDate" (dateRangeChange)="onChangeTodayConsumption()"
                                    [(dateRange)]="_todayConsumptionDate"
                                    [isSingleDate]="'true'"
                                    position="bottom-right"></date-range-picker>
                <app-print-preview [className]="'position-gorelative'" [targetHtml] = "'30MinutConsumption'" [title]="'30 min Consumption'"></app-print-preview>
              </div>
            </div>
            
            <div class="chart-card-body p-3 position-relative">
              <app-total-comsumption [value] = "dailyConsumptionData.chart.total" [unit] = "'kWh'" [type] = "'kWh'"></app-total-comsumption>
              <app-chart-loader [isDone] = "isDone.dailyConsumptionData">
                <app-trend *ngIf="dailyConsumptionData" [dataSource]="dailyConsumptionData"></app-trend>
              </app-chart-loader>
            </div>
          </div>
        </div>
      </div>
      <div class="row ow-eq-height">
        <div class="col-md-12 col-lg-6 col-xl-4 p-1">
          <div class="chart-card h-100" id="equipmentdistribution">
            <div class="chart-card-header">
                <span class="header-title">Equipment Distribution</span>
                <div class="d-flex align-items-center">
                  <date-range-picker [disabled] = "!isDone.equipDistribution" [maxDate]="today" class="d-block" position="bottom-right" (dateRangeChange)="dateRangeListner('eqDist')" [(dateRange)]="eqDIstDateRange"></date-range-picker>
                  <app-print-preview [className]="'position-gorelative'" [targetHtml] = "'equipmentdistribution'" [title]="'Equipment Distribution'"></app-print-preview>
                </div>
            </div>
            
            <div class="chart-card-body p-3 position-relative">
              <!-- <date-range-picker [maxDate]="today" class="d-xl-none" (dateRangeChange)="dateRangeListner('eqDist')" [(dateRange)]="eqDIstDateRange"></date-range-picker> -->
              <app-chart-loader [isDone] = "isDone.equipDistribution">
                <app-pie *ngIf="equipDistribution" [dataSource]="equipDistribution"></app-pie>
              </app-chart-loader>
            </div>
          </div>
        </div>
        <div class="col-md-12 col-lg-6 col-xl-8 p-1">
          <div class="chart-card h-100" id="consumptionSummary">
            <div class="chart-card-header">
              <span class="header-title">Consumption Summary</span>

              <app-toggle-switch [disabled] = "!isDone.trendLogData" aria-disabled="true" (onChange)="setConsumpType($event)">
                <span>Select Category :</span>
              </app-toggle-switch>

              <!-- <app-multiple-select *ngIf="multipleConsump" [selected]="selectedTypes" [options]="eqTypes" (onSelect)="setTypesFilter($event)">
                Category Type
              </app-multiple-select> -->

              <div role="group" class="d-flex align-items-center" aria-label="Trend Log Modes">
                <div class="chart-card-header" style="margin-right: 10px;">
                  <span style="margin-right: 5px;">From:</span>
                  <date-range-picker [disabled] = "!isDone.trendLogData" *ngIf="_reload && !_isMonth && !_isYear"  class="" (dateRangeChange)="onChangeTrendLogByDate(true)" [maxDate] = "_maxDate"
                                      [(dateRange)]="_startDateTrendLog"
                                      [isSingleDate]="'true'"
                                      position="bottom-right"></date-range-picker>
                  <month-date-pciker [disabled] = "!isDone.trendLogData" *ngIf="(_reload && _isMonth) || (_reload && _isYear)" [isYear]="_isYear" [(dateRange)]="_startDateTrendLog" (dateRangeChange)="onChangeTrendLogByDate(true)" [maxDate] ="today"></month-date-pciker>
                  
                </div>
                <span>Last</span>
                <button [disabled] = "!isDone.trendLogData" *ngFor="let item of _mapArrayTrendIndex" class="btn btn-primary btn-circle" [ngClass]="{'active': trendLogTabIndex == item.value}" (click)="setTrendLogData(item.value)">{{item.label}}</button>
                <app-print-preview [className]="'position-gorelative'"  [targetHtml] = "'consumptionSummary'" [title]="'Consumption Summary'"></app-print-preview>

                <!-- <button class="btn btn-primary btn-circle" [ngClass]="{'active': trendLogTabIndex == 0}" (click)="setTrendLogData(0)">7D</button>
                <button class="btn btn-primary btn-circle" [ngClass]="{'active': trendLogTabIndex == 1}" (click)="setTrendLogData(1)">30D</button>
                <button class="btn btn-primary btn-circle" [ngClass]="{'active': trendLogTabIndex == 2}" (click)="setTrendLogData(2)">12M</button>
                <button class="btn btn-primary btn-circle" [ngClass]="{'active': trendLogTabIndex == 3}" (click)="setTrendLogData(3)">5Y</button> -->
              </div>
            </div>
            <div *ngIf="!multipleConsump" class="chart-card-body p-3 position-relative">
              <app-chart-loader [isDone] = "isDone.trendLogData">
                <app-trend *ngIf="trendLogData" [dataSource]="trendLogData"></app-trend>
              </app-chart-loader>
            </div>

            <div *ngIf="multipleConsump" class="chart-card-body p-3">
              <app-consumption-summery-chart></app-consumption-summery-chart>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div class="chart-card m-1" *ngIf="tabIndex == 1">
      <div class="chart-card-body p-3 position-relative">
        <div class="eq-breackdown-position">
          <date-range-picker [disabled] = "!isDone.equipDistributionLg" [maxDate]="today" class="d-block" position="bottom-left"
              [(dateRange)]="eqdistlg" (dateRangeChange)="dateRangeListner('eqdistlg')">
          </date-range-picker>
        </div>
        <div>
          <app-print-preview [targetHtml] = "'8daysProfile'" [title]="'Equipment Distribution'"></app-print-preview>
          <app-chart-loader [isDone] = "isDone.equipDistributionLg">
            <app-doughnut2d *ngIf="equipDistributionLg" [fixedWidth]="true" [dataSource]="equipDistributionLg">
            </app-doughnut2d>
          </app-chart-loader>
        </div>
      </div>
    </div>

    <div class="row" *ngIf="tabIndex == 2">
      <div class="col-md-12 col-lg-12 col-xl-12 pl-0 pr-0 pb-4">
        
        <app-form-container fieldName="Filter Equipment">
          <app-equipment-breakdown-filter-group serviceType="serviceType.ELECTRICAL"  (onFilter)="dataSourceOut($event)" [eqBreakDownFilter]="equipmentBreakdownDateRange" [dataSource]="eqBreakdownFiltered" (onDateRangeChanged)="onEqBreakdownFilter($event)"></app-equipment-breakdown-filter-group>
        </app-form-container>
      </div>
      <div class="col-md-12 col-lg-12 col-xl-12 pl-0 pr-0">
        <app-data-table [isLoading]="tableLoading" [rows]="rows" [columns]="columns"></app-data-table>
      </div>
    </div>

    <div class="row pl-2 pr-2 h-100 " *ngIf="tabIndex == 3">
      <app-dynamic-date-label [dateRange]="meterTreeDateRange"></app-dynamic-date-label>
      <app-chart-loader [isDone] = "!meterTreeLoading">
        <app-meter-tree *ngIf="!meterTreeLoading" type="kWh" mode="true" [dataSource]="meterTreeDatas" class="w-100 p-3 h-100"></app-meter-tree>
      </app-chart-loader>
      <app-floating-button *ngIf="meterTreeDatas" (clickOn)="exportMeter()" [icon]="FileDownloadIcon"></app-floating-button>
    </div>
    <div class="row pl-2 pr-2" *ngIf="tabIndex == 4"><app-reports></app-reports></div>
    <div class="row pl-0 pr-0 h-100" *ngIf="tabIndex == 5">
      <div class="col-md-12 col-lg-12 col-xl-12 pl-0 pr-0 h-100">
        <app-print-preview [className]="'days8'"  [targetHtml] = "'8daysProfile'" [title]="'Electrical Low Tension 8 Days Profile'"></app-print-preview>

        <app-profile-chart level="group" [buildingId]="groupId" [serviceType]="serviceType.ELECTRICAL"></app-profile-chart>
      </div>
    </div>

    <section *ngIf="tabIndex == 6">
      <ums-eui [id]="groupId" [type]=1></ums-eui>
    </section>
    <section *ngIf="tabIndex == 7"><app-alerts></app-alerts></section>
  </div>
