<div *ngIf="isLoading" class="loading-area">
    <img  alt="loader" class="loading-icon" src="assets/img/loader.svg" />
</div>
<div *ngIf="!isLoading" class="d-flex justify-content-center form-content">
    <fieldset class="fieldset">
        <legend>Download Now</legend>
        <form class="m-3" [formGroup]="form" (ngSubmit)="submitForm()">
            <div class="form-group mr-1 ml-1">
                <label for="locationType">Location Category</label><br>
                <select class="w-100 white-select-box" formControlName="locationType" id="locationType" (change)="onChangedLocation($event)">
                    <option value="1">Site</option>
                    <option value="2">Building Group</option>
                    <option value="3">Building</option>
                </select>
            </div>
            Location
            <hr>
            <div class="form-group" formGroupName="location">
                <div class="mr-1 ml-1">
                    <label for="site">Site</label><br>
                    <select class="w-100 white-select-box" formControlName="site" id="site" (change)="onChangedSite($event)">
                        <option value="1">NTU</option>
                    </select>
                </div>
                <div class="d-flex justify-content-around">
                    <div *ngIf="showBuildingGroup" class="mt-3 mr-1 ml-1 w-100">
                        <label for="buildingGroup">Building Group</label><br>
                        <select class="w-100 white-select-box" formControlName="buildingGroup" id="buildingGroup" (change)="onChangedGroup($event.target.value)">
                            <option *ngFor="let buildingGroup of buildingGroups" [value]="buildingGroup.buildingGroupID">{{buildingGroup.description}}</option>
                        </select>
                    </div>
                    <div *ngIf="showBuilding" class="mt-3 mr-1 ml-1 w-100">
                        <label for="building">Building</label><br>
                        <select class="w-100 white-select-box" formControlName="building" id="building" (change)="onChangedBuilding($event.target.value)">
                            <option *ngFor="let building of buildings" [value]="building.buildingID">{{building.buildingName}}</option>
                        </select>
                    </div>
                </div>
            </div>
            Report Type
            <hr>
            <div class="form-group ml-1 d-flex justify-content-between">
                <div class="form-check w-100">
                    <input formControlName="reportType" class="form-check-input" type="radio" (change)="onChangedType($event.target.value)" id="yearly" value="1" checked>
                    <label class="form-check-label" for="yearly">
                        Yearly
                    </label>
                </div>
                <div class="form-check w-100">
                    <input formControlName="reportType" class="form-check-input" type="radio" (change)="onChangedType($event.target.value)" id="monthly" value="2">
                    <label class="form-check-label" for="monthly">
                        Monthly
                    </label>
                </div>
            </div>
            Time
            <hr>
            <div class="form-group d-flex justify-content-around" formGroupName="dateTime">
                <div class="w-100 mr-1 ml-1">
                    <label for="year">Year</label><br>
                    <select class="w-100 white-select-box" formControlName="year" id="year" (change)="onChangeYear()">
                        <option *ngFor="let year of years" [value]="year.value">{{year.year}}</option>
                    </select>
                </div>
                <div *ngIf="showMonth" class="w-100 mr-1 ml-1">
                    <label for="month">Month</label><br>
                    <select class="w-100 white-select-box" formControlName="month" id="month" (change)="getDates($event.target.value); onChangeMonth();">
                        <option *ngFor="let month of months" [value]="month.value">{{month.name}}</option>
                    </select>
                </div>
                <div *ngIf="showDate" class="w-100 mr-1 ml-1">
                    <label for="date">Date</label><br>
                    <select class="w-100 white-select-box" formControlName="date" id="date" (change)="onChangeDate()">
                        <option *ngFor="let date of dates" [value]="date">{{date}}</option>
                    </select>
                </div>
            </div>
            <div *ngIf="selectedReportType == tariffReportType">
                Tariff Details
                <hr>
                <div class="form-group">
                    <ums-tariff [type]="selectedType" [buildingId]="selectedBuilding" [buildingGroupId]="selectedBuildingGroup"></ums-tariff>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-12 pl-0 pr-0">
                    <div class="btn-group w-100" role="group">
                        <button class="btn btn-primary w-50 button-border" (click)="regenerate()" type="button">{{buttonText}}</button>
                        <button [disabled]="buttonText == 'Generate'" class="btn btn-primary w-50 button-border" (click)="downloadAsExcel()" type="button">Download as Excel</button>
                    </div>
                </div>
            </div>
        </form>
    </fieldset>
</div>